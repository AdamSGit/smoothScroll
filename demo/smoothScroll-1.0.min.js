/* Plugin asFastBar
scroll bar design pour votre site web
Developpée par Adam Santoro
http://asfastbar.adamsantoro.fr
*/
(function(e){"use strict";e.fn.smoothScroll=function(t){var n=e.extend({theme:"dark",autoHide:false,opacity:.6,background:false,scrollSpeed:2,delayHideBar:1e3,cssBar:false,cssBg:false,animate:true,barHold:false,barIn:false,msPageY:0,barDiff:0,target:0,scrollDelayTime:false,scrollElement:null,barTop:function(){return parseInt(e("#asBar").css("top"))},barBodyTop:function(){return parseInt(e("#asBarBody").css("top"))},barHeight:function(){return e("#asBar").innerHeight()},barBodyHeight:function(){return e("#asBarBody").innerHeight()},heightScroll:function(){return e(document).scrollTop()},docHeight:document.documentElement.clientHeight,docTotalHeight:e(document).innerHeight(),statutBar:false,date:function(){return(new Date).getTime()},lastScroll:null,timerWheel:false,timerResize:false,lastResize:0,scrollEvent:false,refresh:function(){n.docHeight=document.documentElement.clientHeight;n.docTotalHeight=e(document).innerHeight()}},t);n.scrollSpeed=n.scrollSpeed>3?3:n.scrollSpeed;var r={init:function(){if(!document.getElementById("asBar")){e("html").css("overflow","hidden");n.scrollElement=document.body>0?document.body:document.documentElement;n.statutBar=n.autoHide?false:true;e("body").append(e(document.createElement("div")).attr({id:"asBar"}));e("#asBar").append(e(document.createElement("div")).attr({id:"asBarBody"}));r.setBarSize();var t=n.theme=="dark"?"#000":"#fff",i="transparent",s=0;if(n.background){i=n.theme=="dark"?"#fff":"#000";s=n.opacity}e("#asBar").css({background:i,opacity:s});e("#asBarBody").css({background:t});e("#asBar, #asBarBody").css({position:"fixed",right:"2px",top:"7px",width:"8px"});if(n.cssBg)e("#asBar").css(n.cssBg);if(n.cssBar)e("#asBarBody").css(n.cssBar);!n.statutBar?e("#asBar, #asBarBody").css("opacity",0):e("#asBar, #asBarBody").css("opacity",0);r.checker()}},setBarSize:function(){n.timerResize=setTimeout(function(){if((n.date()/1e3).toFixed(1)-(n.lastResize/1e3).toFixed(1)>=.5){n.refresh();e("#asBar").css("height",n.docHeight-14+"px");e("#asBarBody").css("height",(n.docHeight-14)/(n.docTotalHeight/n.docHeight)+"px");r.setBPos()}},500)},setBPos:function(){if(!n.scrollEvent){var t=n.heightScroll()/(n.docTotalHeight/n.docHeight),r=n.barTop();t=t<r?r:t;n.animate?e("#asBarBody").animate({top:t+"px"},{duration:20}):e("#asBarBody").css({top:t+"px"})}else n.scrollEvent=false;n.timerResize=false},hideBar:function(){n.timerWheel=setTimeout(function(){if(!n.barIn){if(Math.round(n.date()/1e3)-n.lastScroll>=n.delayHideBar/1e3){n.statutBar=false;e("#asBar, #asBarBody").animate({opacity:0},"slow")}}},n.delayHideBar)},showBar:function(){if(!n.statutBar){n.statutBar=true;e("#asBar, #asBarBody").animate({opacity:n.opacity},"fast")}},checker:function(){setInterval(function(){if(!n.timerResize)r.setBarSize()},1e3)}};return this.each(function(){var t=e(this);r.init.call(window);var i="DOMMouseScroll"in window?"DOMMouseScroll":"mousewheel";e(this).scroll(function(){if(!n.barHold)r.setBPos()});e(window).resize(function(){n.lastResize=n.date();if(n.timerResize){clearTimeout(n.timerResize);n.timerResize=false}r.setBarSize()});e(this).bind(i+" keydown",function(e){var t=n.heightScroll();var i=25*n.scrollSpeed;var s=e.originalEvent.detail?-e.originalEvent.detail:e.originalEvent.wheelDelta;if(s>=0||!s&&e.keyCode==38){if(t>0&&t<i)scrollTo(0,0);else if(t>0)scrollBy(0,-i)}else if(s<0||!s&&e.keyCode==40){scrollBy(0,i)}if(n.autoHide){n.lastScroll=Math.round(n.date()/1e3);if(n.timerWheel){clearTimeout(n.timerWheel);n.timerWheel=false}r.hideBar();r.showBar()}});e(document).on("dragstart",function(e){return false});e(document).on("mousedown","#asBarBody",function(t){e("html").attr("unselectable","on").css("user-select","none");n.barHold=true;n.msPageY=t.pageY-n.heightScroll();n.barDiff=n.msPageY-n.barBodyTop();n.target=e(t.target);t.stopImmediatePropagation()}).on("mouseup",function(){if(n.barHold){n.barHold=false;e("html").removeAttr("unselectable").css("user-select","all");if(n.autoHide&&n.statutBar){setTimeout(function(){if(n.statutBar&&!n.barIn){e("#asBar, #asBarBody").animate({opacity:0},"slow");n.statutBar=false}},n.delayHideBar)}}n.target=null});e(e(this)).on("mousemove",function(t){if(n.barHold&&!n.scrollDelayTime&&n.target){n.scrollDelayTime=true;setTimeout(function(){var r=n.heightScroll(),i=n.barBodyTop(),s=n.barTop(),o=n.barHeight(),u=n.barBodyHeight(),a=t.pageY-r-n.barDiff,f=0;if(s&&n.target!=null){f=a>s?a:s;if(a>o-u)f=o-u+s;n.animate?n.target.animate({top:f+"px"},{duration:40}):n.target.css({top:f+"px"});e(n.scrollElement).scrollTop(parseInt((n.docTotalHeight-n.docHeight)*(i-s)/(o-u)));n.scrollEvent=true}console.log(a);n.scrollDelayTime=false},80)}});if(n.autoHide){e(document).on("mouseenter","#asBar",function(e){if(n.autoHide){r.showBar()}n.barIn=true}).on("mouseleave","#asBar",function(t){if(!n.barHold){setTimeout(function(){if(!n.statutBar)e("#asBar, #asBarBody").animate({opacity:0},"slow")},n.delayHideBar);n.statutBar=false}n.barIn=false})}})}})(jQuery)